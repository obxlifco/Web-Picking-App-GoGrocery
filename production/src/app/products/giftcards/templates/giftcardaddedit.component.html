<section class="right-part addall_page">
  <div class="body-part addorderbody addorderbodypart" *ngIf="_globalService.isFormLoaded == 'Yes'">
      <form #formData="ngForm" novalidate (ngSubmit)="formData.valid && addEdit()">
          <input type="hidden" name="formId" [(ngModel)]="formModel.formId">
          <div class="topheading">
              <h1>{{(formModel.formId>0)?'Edit':'Add'}} Gift Card
          <div class="btn-header">
          <div class="btn-header">
              <button type="submit" mat-raised-button class="btn-main">Save</button>
              <button type="button" mat-raised-button class="btn-line" (click)="_globalService.deleteTab(tabIndex,parentId)">Cancel</button>
            </div>
        </div>
        <div class="clear"></div>
        </h1> </div>
          <div class="clear"></div>
          <div class="box">
              <div class="fixed-width">
                  <div class="alert alert-success" *ngIf="successMsg">{{successMsg}}</div>
                  <div class="alert alert-danger" *ngIf="errorMsg">{{errorMsg}}</div>
                  <div class="row">
                      <div class="col-sm-4" >
                          <mat-form-field appearance="outline" class="md-block">
                              <mat-label>Name</mat-label>
                              <input matInput  placeholder="Name" required #card_name="ngModel" name="card_name" [(ngModel)]="formModel.card_name" pattern="^(?!\s*$|\s).*$">
                              <mat-error *ngIf="card_name.errors && card_name.errors.required"> This is a <strong>required</strong> field </mat-error>
                              <mat-error *ngIf="card_name.errors && card_name.errors.pattern"> White space is not allowed at beginning.</mat-error>
                          </mat-form-field>
                      </div>
                      <div class="col-sm-4" *ngIf="formModel.formId>0">
                        <mat-form-field appearance="outline" class="md-block">
                            <mat-label>Card number</mat-label>
                            <input matInput [disabled]="formModel.formId>0" placeholder="Card number" required #card_number="ngModel" name="card_number" [(ngModel)]="formModel.card_number" pattern="^(?!\s*$|\s).*$">
                            <mat-error *ngIf="card_number.errors && card_number.errors.required"> This is a <strong>required</strong> field </mat-error>
                            <mat-error *ngIf="card_number.errors && card_number.errors.pattern"> White space is not allowed at beginning.</mat-error>
                        </mat-form-field>
                      </div>
                      <div class="col-sm-4">
                        <mat-form-field appearance="outline" class="md-block">
                            <mat-label>Amount</mat-label>
                            <input matInput  placeholder="Amount" required #amount="ngModel" name="amount" [(ngModel)]="formModel.amount" pattern="^\d*\.?\d*$">
                            <mat-error *ngIf="amount.errors && amount.errors.required"> This is a <strong>required</strong> field </mat-error>
                            <mat-error *ngIf="amount.errors && amount.errors.pattern"> This is not a valid input.</mat-error>
                        </mat-form-field>
                      </div>
                      <div class="col-sm-4" *ngIf="!formModel.formId">
                        <mat-form-field appearance="outline" class="md-block">
                          <mat-label>Start Date</mat-label>
                          <input matInput  placeholder="Start Date" [owlDateTime]="picker" [owlDateTimeTrigger]="picker" required (focus)="picker.open()"  name="start_date" #start_date="ngModel" [(ngModel)]="formModel.start_date">
                        <owl-date-time #picker></owl-date-time>
                        </mat-form-field>
                      </div>
                      <div class="col-sm-4" *ngIf="this.formModel.formId == 0">
                        <mat-form-field appearance="outline" class="md-block">
                          <mat-label>No. of code</mat-label>
                            <input type="number" matInput placeholder="No. of code" required #noOfCode="ngModel"  name="noOfCode" [(ngModel)]="formModel.number_of_coupon" min="1">
                            <mat-error *ngIf="noOfCode.errors && noOfCode.errors.required">
                              This is a <strong>required</strong> field
                            </mat-error>
                            <mat-error *ngIf="noOfCode.errors && noOfCode.errors.min">
                              Must be <strong>greater </strong> than zero
                            </mat-error>
                        </mat-form-field> 
                      </div>
                  </div>
                  <div class="row">
                    <div  [className]="formModel.formId>0 ? 'col-sm-6' : 'col-sm-4'">
                      <mat-form-field appearance="outline" class="md-block">
                        <mat-label>Start Date</mat-label>
                        <input matInput  placeholder="Start Date" parseInput [owlDateTime]="picker" [owlDateTimeTrigger]="picker" required (focus)="picker.open()"  name="start_date" #start_date="ngModel" [(ngModel)]="formModel.start_date">
                      <owl-date-time #picker></owl-date-time>
                      </mat-form-field>
                    </div>
                    <div [className]="formModel.formId>0 ? 'col-sm-6' : 'col-sm-4'">
                      <mat-form-field appearance="outline" class="md-block">
                        <mat-label>End Date</mat-label>
                        <input matInput  placeholder="End Date" [owlDateTime]="picker1" required [owlDateTimeTrigger]="picker1" (focus)="picker1.open()"  name="end_date" #end_date="ngModel" [(ngModel)]="formModel.end_date">
                      <owl-date-time #picker1></owl-date-time>
                      </mat-form-field>			
                    </div>
                    
                    <div class="col-sm-4" *ngIf="this.formModel.formId == 0">
                      <button type="button" class="margin-auto20  btn-pink btn-pink-decor" mat-option-button (click)="generateCode(formModel.generate_couponcode)"  matTooltip="Generate Gift Code">
                        <mat-option class="icon-tag"></mat-option>
                      </button>
                    </div>
                  </div>
                  <div class="row" *ngIf="formModel.coupon_codes">
                    <div class="col-sm-12">
                      <h6>Generated Gift Codes</h6>
                      <mat-chip-list>
                        <mat-chip *ngFor="let code of formModel.coupon_codes" color="(code.is_used=='y')?'accent':''">{{(formModel.coupon_prefix?formModel.coupon_prefix:'')+code.coupon_code+(formModel.coupon_suffix?formModel.coupon_suffix:'')}}</mat-chip>
                      </mat-chip-list>
                    </div>
                  </div>	
              </div>
              <!-- ///////////////Buttons//// -->
              <div class="btn-header hidden-xs">
                  <button type="submit" mat-raised-button class="btn-main">Save</button>
                  <button type="button" mat-raised-button class="btn-line" (click)="_globalService.deleteTab(tabIndex,parentId)">Cancel</button>
              </div>
              <div class="clear"></div>
              <!-- ///////////////Buttons//// -->
          </div>
          <div class="clear"></div>
      </form>
  </div>
</section>